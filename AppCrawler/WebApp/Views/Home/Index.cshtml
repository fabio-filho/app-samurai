@using Domain.Entities;
@model IEnumerable<Domain.Entities.App>


<div class="input-group" data-toggle="buttons" style="margin-bottom: 10px;">

    @{
        if (ViewBag.p == "a")
        {
            <label class='btn btn-secondary' style="margin-bottom: 0px; margin-right: 5px;" onclick="toggleMarketPlace('g');">
                <input type="radio" name="rb_google_play" id="rb_google_play" autocomplete="off"> Google Play
            </label>

            <label class='btn btn-secondary active' style="margin-bottom: 0px; margin-right: 10px;" onclick="toggleMarketPlace('a');">
                <input type="radio" name="rb_apple" id="rb_apple" autocomplete="off"> Apple
            </label>
        }
        else
        {
            <label class='btn btn-secondary active' style="margin-bottom: 0px; margin-right: 5px;" onclick="toggleMarketPlace('g');">
                <input type="radio" name="rb_google_play" id="rb_google_play" autocomplete="off"> Google Play
            </label>

            <label class='btn btn-secondary' style="margin-bottom: 0px; margin-right: 10px;" onclick="toggleMarketPlace('a');">
                <input type="radio" name="rb_apple" id="rb_apple" autocomplete="off"> Apple
            </label>
        }
    }    

    <input id="mTextCountry" list="countries" type="text" class="form-control" placeholder="Country ..." value="@ViewBag.c?.ToString().ToUpper()"/>
    <datalist id="countries">
        <option value="AF">Afghanistan</option>
        <option value="AL">Albania</option>
        <option value="DZ">Algeria</option>
        <option value="AS">American Samoa</option>
        <option value="AD">Andorra</option>
        <option value="AO">Angola</option>
        <option value="AI">Anguilla</option>
        <option value="AQ">Antarctica</option>
        <option value="AG">Antigua and Barbuda</option>
        <option value="AR">Argentina</option>
        <option value="AM">Armenia</option>
        <option value="AW">Aruba</option>
        <option value="AU">Australia</option>
        <option value="AT">Austria</option>
        <option value="AZ">Azerbaijan</option>
        <option value="BS">Bahamas</option>
        <option value="BZ">Belize</option>
        <option value="BJ">Benin</option>
        <option value="BM">Bermuda</option>
        <option value="BT">Bhutan</option>
        <option value="BO">Bolivia, Plurinational State of</option>
        <option value="BQ">Bonaire, Sint Eustatius and Saba</option>
        <option value="BA">Bosnia and Herzegovina</option>
        <option value="BW">Botswana</option>
        <option value="BV">Bouvet Island</option>
        <option value="BR">Brazil</option>
        <option value="IO">British Indian Ocean Territory</option>
        <option value="BG">Bulgaria</option>
        <option value="CM">Cameroon</option>
        <option value="CA">Canada</option>
        <option value="CV">Cape Verde</option>
        <option value="KY">Cayman Islands</option>
        <option value="CF">Central African Republic</option>
        <option value="TD">Chad</option>
        <option value="CL">Chile</option>
        <option value="CN">China</option>
        <option value="CX">Christmas Island</option>
        <option value="CC">Cocos (Keeling) Islands</option>
        <option value="CO">Colombia</option>
        <option value="KM">Comoros</option>
        <option value="HR">Croatia</option>
        <option value="CU">Cuba</option>
        <option value="CW">Curaçao</option>
        <option value="CY">Cyprus</option>
        <option value="CZ">Czech Republic</option>
        <option value="DK">Denmark</option>
        <option value="DJ">Djibouti</option>
        <option value="DM">Dominica</option>
        <option value="DO">Dominican Republic</option>
        <option value="EC">Ecuador</option>
        <option value="EG">Egypt</option>
        <option value="SV">El Salvador</option>
        <option value="GQ">Equatorial Guinea</option>
        <option value="FR">France</option>
        <option value="GF">French Guiana</option>
        <option value="PF">French Polynesia</option>
        <option value="TF">French Southern Territories</option>
        <option value="GA">Gabon</option>
        <option value="GM">Gambia</option>
        <option value="GE">Georgia</option>
        <option value="DE">Germany</option>
        <option value="GW">Guinea-Bissau</option>
        <option value="GY">Guyana</option>
        <option value="HT">Haiti</option>
        <option value="HM">Heard Island and McDonald Islands</option>
        <option value="VA">Holy See (Vatican City State)</option>
        <option value="HN">Honduras</option>
        <option value="HK">Hong Kong</option>
        <option value="HU">Hungary</option>
        <option value="IS">Iceland</option>
        <option value="IN">India</option>
        <option value="ID">Indonesia</option>
        <option value="IR">Iran, Islamic Republic of</option>
        <option value="IQ">Iraq</option>
        <option value="IE">Ireland</option>
        <option value="IM">Isle of Man</option>
        <option value="IL">Israel</option>
        <option value="IT">Italy</option>
        <option value="JM">Jamaica</option>
        <option value="JP">Japan</option>
        <option value="JE">Jersey</option>
        <option value="JO">Jordan</option>
        <option value="KZ">Kazakhstan</option>
        <option value="KE">Kenya</option>
        <option value="KI">Kiribati</option>
        <option value="KP">Korea, Democratic People's Republic of</option>
        <option value="KR">Korea, Republic of</option>
        <option value="MX">Mexico</option>
        <option value="FM">Micronesia, Federated States of</option>
        <option value="MD">Moldova, Republic of</option>
        <option value="MC">Monaco</option>
        <option value="MN">Mongolia</option>
        <option value="ME">Montenegro</option>
        <option value="MS">Montserrat</option>
        <option value="MA">Morocco</option>
        <option value="MZ">Mozambique</option>
        <option value="PY">Paraguay</option>
        <option value="PE">Peru</option>
        <option value="PH">Philippines</option>
        <option value="PN">Pitcairn</option>
        <option value="PL">Poland</option>
        <option value="PT">Portugal</option>
        <option value="PR">Puerto Rico</option>
        <option value="QA">Qatar</option>
        <option value="RE">Réunion</option>
        <option value="RO">Romania</option>
        <option value="RU">Russian Federation</option>
        <option value="RW">Rwanda</option>
        <option value="SC">Seychelles</option>
        <option value="SL">Sierra Leone</option>
        <option value="SG">Singapore</option>
        <option value="SX">Sint Maarten (Dutch part)</option>
        <option value="SK">Slovakia</option>
        <option value="SI">Slovenia</option>
        <option value="SB">Solomon Islands</option>
        <option value="SO">Somalia</option>
        <option value="ZA">South Africa</option>
        <option value="SJ">Svalbard and Jan Mayen</option>
        <option value="SZ">Swaziland</option>
        <option value="TT">Trinidad and Tobago</option>
        <option value="TN">Tunisia</option>
        <option value="TR">Turkey</option>
        <option value="AE">United Arab Emirates</option>
        <option value="GB">United Kingdom</option>
        <option value="US">United States</option>
        <option value="UY">Uruguay</option>
        <option value="VE">Venezuela, Bolivarian Republic of</option>
    </datalist>

</div>
    
<div class="input-group" data-toggle="buttons" style="margin-bottom: 10px;">

    <input id="txt_search" type="text" class="form-control" placeholder="Search for..." value="@ViewBag.q">

    <span class="input-group-btn">
        <button class="btn btn-secondary" onclick="onSearch();">Go!</button>
    </span>

</div>

    <br />

    <div class="row">

        @{
            if (Model != null)
            {
                foreach (var item in Model)
                {
                    <div class="col-md-4">
                        <img class="rounded-circle" src="@Html.DisplayFor(modelItem => item.Icon)" alt="Generic placeholder image" width="140" height="140">
                        <h2>@Html.DisplayFor(modelItem => item.Name)</h2>
                        <p style="margin-bottom: 0px;">@Html.DisplayFor(modelItem => item.SubTitle)  @Html.DisplayFor(modelItem => item.Rating)</p>
                        <small style="margin-bottom: 10px; margin-top: 0px;">
                            @Html.DisplayFor(modelItem => item.ReducedDescription)
                        </small>
                        @if (@Html.DisplayFor(modelItem => item.ReducedDescription).ToString() != string.Empty)
                        {
                            <br />
                        }
                        <p style="margin-top: 10px;"><a class="btn btn-secondary" onclick="onSearchDetails('@Html.DisplayFor(modelItem => item.Package)');" role="button">View details &raquo;</a></p>
                    </div>
                }
            }
        }

    </div>

<script>

    var p = "@ViewBag.p?.ToString().toLower()";
    var c = "@ViewBag.c?.ToString().toLower()";

    function toggleMarketPlace(data) {
        p = data;        
    }

    function onSearch() {
        var txt_search = document.getElementById('txt_search').value.toLowerCase();
        var country = document.getElementById("mTextCountry").value.toLowerCase();

        if (country.trim().length == 0)
            country = "us";
                
        location.href = '?p=' + p + '&q=' + txt_search + '&c=' + country;
    }

    function onSearchDetails(data) {
               
        location.href = 'Home/Details?p=' + p + '&q=' + data + '&c=' + country;
    }

    document.getElementById("txt_search")
        .addEventListener("keyup", function (event) {
            event.preventDefault();
            if (event.keyCode == 13) {
                onSearch();
            }
        });

</script>


